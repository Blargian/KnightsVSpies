{"version":3,"file":"server.js","mappings":"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","sources":["webpack://spyspy/./client/reducers.js","webpack://spyspy/./server/controllers/gameController.js","webpack://spyspy/./server/models/room.js","webpack://spyspy/./server/socket.js","webpack://spyspy/external commonjs \"@reduxjs/toolkit\"","webpack://spyspy/external commonjs \"express\"","webpack://spyspy/external commonjs \"randomstring\"","webpack://spyspy/external commonjs \"socket.io\"","webpack://spyspy/external commonjs \"socket.io-client\"","webpack://spyspy/external node-commonjs \"http\"","webpack://spyspy/external node-commonjs \"path\"","webpack://spyspy/webpack/bootstrap","webpack://spyspy/webpack/runtime/compat get default export","webpack://spyspy/webpack/runtime/define property getters","webpack://spyspy/webpack/runtime/hasOwnProperty shorthand","webpack://spyspy/webpack/runtime/make namespace object","webpack://spyspy/./server/server.js"],"sourcesContent":["import { configureStore, createSlice, combineReducers, PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst initialState = {\r\n    game: {\r\n        missionLeader: false,\r\n        leaderSelection: [],\r\n        round: 0,\r\n        closeEyes: false,\r\n        spies: [],\r\n        knights: [],\r\n        votesPass: 0,\r\n        votesFail: 0,\r\n    }\r\n}\r\n\r\nconst initialRoomState = {\r\n    selfId: '',\r\n    selfAlias: '',\r\n    players: [],\r\n    roomCode: '',\r\n}\r\n\r\nconst roomsSlice = createSlice({\r\n    name: \"room\",\r\n    initialState:initialRoomState,\r\n    reducers: {\r\n        ioCreateRoom(state,action){\r\n        },\r\n        roomCreated(state,{action,payload}){\r\n            state.roomCode = payload.roomCode;\r\n            state.selfId = payload.selfId; \r\n            return state; \r\n        }\r\n    }\r\n});\r\n\r\n//Root reducer for usage in the store\r\nexport const rootReducer = combineReducers({\r\n    room: roomsSlice.reducer\r\n});\r\n\r\n//Make action creators accesible \r\nexport const {\r\n    ioCreateRoom,\r\n    roomCreated,\r\n} = roomsSlice.actions;\r\n\r\n","import {\r\n    ioCreateRoom,\r\n    roomCreated\r\n} from '../../client/reducers';\r\nimport { Room } from '../models/room';\r\n\r\n// one instance is made on server start up\r\nexport default class GameController{\r\n\r\n    constructor(io){\r\n        this.io = io; \r\n        this.rooms = []\r\n        this.connect();\r\n    }\r\n\r\n    connect(){\r\n        this.io.on(\"connection\", (socket) => {\r\n\r\n            //sets up listener for room\r\n            socket.on(ioCreateRoom.type,(payload)=>{\r\n                \r\n                console.log('Creating new room')\r\n                const newRoom = new Room();\r\n                this.rooms.push(newRoom);\r\n                //emits action with room as payload, playerid\r\n                socket.emit(roomCreated.type,{\r\n                    roomCode: newRoom.roomCode,\r\n                    selfId: 'dummy_value'\r\n                })\r\n            });\r\n    \r\n            //sets up listener for connect code\r\n            socket.on(\"room/ioJoinRoom\",()=>{})\r\n            //check to see if the room code exists\r\n                //add player to game if it does\r\n                //emits action for setting roomcode, playerid\r\n            //if it doesn't \r\n                //dispatch an error action\r\n        });\r\n    }\r\n}\r\n\r\n","import randomstring from \"randomstring\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nexport class Room {\r\n\r\n    constructor(callingPlayer){\r\n        this.roomCode = this.generateRoomCode();\r\n        this.players = [];\r\n    }\r\n\r\n    generateRoomCode(){\r\n        return randomstring.generate({\r\n            length: 6,\r\n            charset: 'alphanumeric'\r\n        });\r\n    }\r\n\r\n    addCallingPlayer(player){\r\n        this.players.push({\r\n            playerID:callingPlayer.id,\r\n            readyToStart: false\r\n        });\r\n    }\r\n}","import { Server } from 'socket.io';\r\nimport path from 'path';\r\n\r\nexport default (httpServer) => {\r\n\r\n    console.log('Setting up socket.io server...');\r\n    const io = new Server(httpServer,{\r\n        cors: {\r\n            origin: \"*\"\r\n        },\r\n    });\r\n\r\n    return io;\r\n}","module.exports = require(\"@reduxjs/toolkit\");","module.exports = require(\"express\");","module.exports = require(\"randomstring\");","module.exports = require(\"socket.io\");","module.exports = require(\"socket.io-client\");","module.exports = require(\"http\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import express from 'express';\r\nimport socketServer from \"./socket\";\r\nimport {createServer} from 'http';\r\nimport path from 'path';\r\nconst publicPath = path.join(__dirname, '..', 'public');\r\nimport GameController from './controllers/gameController';\r\n\r\nconst expressServer = express();\r\nexpressServer.use(express.static(publicPath));\r\nexpressServer.get('*', (req, res)=>{\r\n    res.sendFile(path.join(publicPath,'index.html'));\r\n})\r\n\r\nconst httpServer = createServer(expressServer);\r\n\r\nconst io = socketServer(httpServer);\r\n\r\nhttpServer.listen(3000, ()=> {\r\n    console.log(`Server running on http://localhost:3000`);\r\n});\r\n\r\nconst gameController = new GameController(io);\r\n\r\n\r\n"],"names":["configureStore","createSlice","combineReducers","PayloadAction","initialState","game","missionLeader","leaderSelection","round","closeEyes","spies","knights","votesPass","votesFail","initialRoomState","selfId","selfAlias","players","roomCode","roomsSlice","name","reducers","ioCreateRoom","state","action","roomCreated","payload","rootReducer","room","reducer","actions","Room","GameController","io","rooms","connect","on","socket","type","console","log","newRoom","push","emit","randomstring","callingPlayer","generateRoomCode","generate","length","charset","player","playerID","id","readyToStart","Server","path","httpServer","cors","origin","express","socketServer","createServer","publicPath","join","__dirname","expressServer","use","get","req","res","sendFile","listen","gameController"],"sourceRoot":""}