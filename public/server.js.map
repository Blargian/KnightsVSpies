{"version":3,"file":"server.js","mappings":"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","sources":["webpack://spyspy/./client/reducers.js","webpack://spyspy/./server/controllers/gameController.js","webpack://spyspy/./server/controllers/mainController.js","webpack://spyspy/./server/models/room.js","webpack://spyspy/./server/socket.js","webpack://spyspy/external commonjs \"@reduxjs/toolkit\"","webpack://spyspy/external commonjs \"chalk\"","webpack://spyspy/external commonjs \"express\"","webpack://spyspy/external commonjs \"randomstring\"","webpack://spyspy/external commonjs \"socket.io\"","webpack://spyspy/external commonjs \"socket.io-client\"","webpack://spyspy/external node-commonjs \"http\"","webpack://spyspy/external node-commonjs \"path\"","webpack://spyspy/webpack/bootstrap","webpack://spyspy/webpack/runtime/compat get default export","webpack://spyspy/webpack/runtime/define property getters","webpack://spyspy/webpack/runtime/hasOwnProperty shorthand","webpack://spyspy/webpack/runtime/make namespace object","webpack://spyspy/./server/server.js"],"sourcesContent":["import { configureStore, createSlice, combineReducers, PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst initialState = {\r\n    game: {\r\n        missionLeader: false,\r\n        leaderSelection: [],\r\n        round: 0,\r\n        closeEyes: false,\r\n        spies: [],\r\n        knights: [],\r\n        votesPass: 0,\r\n        votesFail: 0,\r\n    }\r\n}\r\n\r\nconst initialRoomState = {\r\n    selfId: '',\r\n    selfAlias: '',\r\n    players: [],\r\n    roomCode: '',\r\n}\r\n\r\nconst roomsSlice = createSlice({\r\n    name: \"room\",\r\n    initialState:initialRoomState,\r\n    reducers: {\r\n        ioCreateRoom(state,action){\r\n        },\r\n        roomCreated(state,{action,payload}){\r\n            return {...state,...payload}; \r\n        },\r\n        ioEnterRoomCode(state,{action,payload}){            \r\n        },\r\n        updatePlayers(state,{action,payload}){\r\n            return {...state, players: payload}\r\n        },\r\n        updateSelf(state,{action,payload}){\r\n            return {\r\n                ...state,\r\n                ...payload\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n});\r\n\r\n//Root reducer for usage in the store\r\nexport const rootReducer = combineReducers({\r\n    room: roomsSlice.reducer\r\n});\r\n\r\n//Make action creators accesible \r\nexport const {\r\n    ioCreateRoom,\r\n    roomCreated,\r\n    navigateToLobby,\r\n    ioEnterRoomCode,\r\n    updatePlayers,\r\n    updateSelf\r\n} = roomsSlice.actions;\r\n\r\n","import {\r\n    roomCreated,\r\n    updatePlayers,\r\n    updateSelf\r\n} from '../../client/reducers';\r\n\r\nimport { Room } from '../models/room';\r\nimport chalk from 'chalk';\r\n\r\n// one instance is made on server start up\r\nexport default class GameController{\r\n\r\n    constructor(){\r\n        this.rooms = new Map();\r\n        this.playersToRooms = new Map();\r\n    }\r\n\r\n    createRoom = function(io,playerId){\r\n        const newRoom = new Room(playerId);\r\n        this.addToRoomMap(newRoom);\r\n        this.addPlayerToRoomMap(newRoom,playerId);\r\n        io.to(playerId).emit(roomCreated.type,this.formattedRoom(newRoom,playerId));\r\n        return newRoom.roomCode\r\n    }\r\n\r\n    joinRoom = function(enteredRoomCode,io,socket){\r\n        if(this.checkRoomExists(enteredRoomCode)){\r\n            socket.join(enteredRoomCode);\r\n            const room = this.rooms.get(enteredRoomCode)\r\n            this.addPlayerToRoomMap(room,socket.id)\r\n            const players = this.addPlayerToRoom(enteredRoomCode,socket.id)\r\n            //update this players state \r\n            io.to(socket.id).emit(updateSelf.type,this.formattedPlayer(enteredRoomCode,players,socket.id));\r\n            //update all players state with the list of players\r\n            io.in(enteredRoomCode).emit(updatePlayers.type,players);\r\n        } else{\r\n            \r\n        }          \r\n    }\r\n\r\n    playerLeft = function(playerId,io){\r\n        try{\r\n            console.log(chalk.blue(`removing player: ${playerId}`))\r\n            this.removePlayerFromRoom(playerId,io)\r\n        } catch(error){\r\n            console.log(chalk.red('an error occured trying to remove a player from their room'));\r\n            console.log(error);\r\n        }  \r\n    }\r\n\r\n    addToRoomMap = function(newRoom){\r\n        return this.rooms.set(newRoom.roomCode,newRoom);\r\n    }\r\n\r\n    addPlayerToRoomMap = function(newRoom,playerId){\r\n        return this.playersToRooms.set(playerId,newRoom.roomCode);\r\n    }\r\n\r\n    formattedRoom = function(newRoom,playerId){\r\n        return {\r\n            roomCode: newRoom.roomCode,\r\n            selfId: playerId,\r\n            selfAlias: newRoom.players[0].selfAlias,\r\n            players: newRoom.players\r\n        }\r\n    }\r\n\r\n    formattedPlayer = function(roomCode, playersArray,playerId){\r\n\r\n        const selfAlias = playersArray.filter((player)=>{\r\n            return player.selfId === playerId\r\n        }).selfAlias\r\n\r\n        return {\r\n            roomCode: roomCode, \r\n            selfId: playerId,\r\n            selfAlias\r\n        }\r\n    }\r\n\r\n    checkRoomExists(enteredCode){\r\n        return this.rooms.has(enteredCode)\r\n    }\r\n\r\n    addPlayerToRoom(enteredRoomCode, player){\r\n        let room = this.rooms.get(enteredRoomCode);\r\n        if(room){\r\n            if(room.players.length<10){\r\n                room.addPlayer(player);\r\n            }\r\n            return room.players;\r\n        } else {\r\n            console.log(chalk.red(`no room was found for ${enteredCode}`))\r\n        }\r\n    }\r\n\r\n    removePlayerFromRoom(playerId,io){\r\n        \r\n        console.log(playerId)\r\n        if(this.playersToRooms.size===0){\r\n            return;\r\n        }\r\n            \r\n        let roomName = this.playersToRooms.get(playerId);\r\n        \r\n        function logMapElements(value, key, map) {\r\n            console.log(`m[${key}] = ${value}`);\r\n          }\r\n          \r\n          this.playersToRooms.forEach(logMapElements);\r\n\r\n        let playerRoom = this.rooms.get(roomName);\r\n        console.log(chalk.green(playerRoom))\r\n        console.log(chalk.green(this.rooms))\r\n        let remainingPlayers = playerRoom.players.filter((player)=>{\r\n            return player.playerID !== playerId\r\n        });\r\n\r\n        playerRoom = {\r\n            ...playerRoom, \r\n            players:remainingPlayers\r\n        }\r\n\r\n        if(playerRoom.players.length===0){\r\n            this.rooms.delete(roomName);    \r\n        } else {\r\n            this.rooms.set(roomName,playerRoom);\r\n            io.in(roomName).emit(updatePlayers.type,remainingPlayers);\r\n        } \r\n    }\r\n}\r\n\r\n\r\n","import GameController from \"./gameController\";\r\nimport {\r\n    ioCreateRoom,\r\n    ioEnterRoomCode,\r\n} from '../../client/reducers';\r\n\r\n//Handles socket \r\nexport default class MainController {\r\n    constructor(io){\r\n        this.io = io;\r\n        this.gamecontroller = new GameController();\r\n\r\n        this.io.on(\"connection\", (socket) => {\r\n\r\n            socket.on(ioCreateRoom.type,()=>{\r\n                socket.join(this.gamecontroller.createRoom(this.io,socket.id));\r\n            });\r\n    \r\n            socket.on(ioEnterRoomCode.type,(enteredRoomCode)=>{\r\n                 this.gamecontroller.joinRoom(enteredRoomCode,this.io,socket);\r\n            });\r\n\r\n            socket.on(\"disconnect\",()=>{\r\n               this.gamecontroller.playerLeft(socket.id,this.io)\r\n            })\r\n        });\r\n    }\r\n}","import randomstring from \"randomstring\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nexport class Room {\r\n\r\n    //callingPlayerId: socket.id\r\n    constructor(callingPlayerId){\r\n        this.roomCode = this.generateRoomCode();\r\n        this.players = [];\r\n        this.addPlayer(callingPlayerId)\r\n    }\r\n\r\n    generateRoomCode = function(){\r\n        return randomstring.generate({\r\n            length: 6,\r\n            charset: 'alphanumeric'\r\n        });\r\n    }\r\n\r\n    addPlayer = function(callingPlayerId){\r\n        this.players.push({\r\n            playerID:callingPlayerId,\r\n            selfAlias:`Player${this.players.length+1}`,\r\n            readyToStart: false\r\n        });\r\n    }\r\n\r\n}","import { Server } from 'socket.io';\r\nimport path from 'path';\r\n\r\nexport default (httpServer) => {\r\n\r\n    console.log('Setting up socket.io server...');\r\n    const io = new Server(httpServer,{\r\n        cors: {\r\n            origin: \"*\"\r\n        },\r\n    });\r\n\r\n    return io;\r\n}","module.exports = require(\"@reduxjs/toolkit\");","module.exports = require(\"chalk\");","module.exports = require(\"express\");","module.exports = require(\"randomstring\");","module.exports = require(\"socket.io\");","module.exports = require(\"socket.io-client\");","module.exports = require(\"http\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import express from 'express';\r\nimport socketServer from \"./socket\";\r\nimport {createServer} from 'http';\r\nimport path from 'path';\r\nconst publicPath = path.join(__dirname, '..', 'public');\r\nimport MainController from './controllers/mainController';\r\n\r\nconst expressServer = express();\r\nexpressServer.use(express.static(publicPath));\r\nexpressServer.get('*', (req, res)=>{\r\n    res.sendFile(path.join(publicPath,'index.html'));\r\n})\r\n\r\nconst httpServer = createServer(expressServer);\r\n\r\nconst io = socketServer(httpServer);\r\n\r\nhttpServer.listen(3000, ()=> {\r\n    console.log(`Server running on http://localhost:3000`);\r\n});\r\n\r\nconst mainController = new MainController(io);\r\n\r\n\r\n"],"names":["configureStore","createSlice","combineReducers","PayloadAction","initialState","game","missionLeader","leaderSelection","round","closeEyes","spies","knights","votesPass","votesFail","initialRoomState","selfId","selfAlias","players","roomCode","roomsSlice","name","reducers","ioCreateRoom","state","action","roomCreated","payload","ioEnterRoomCode","updatePlayers","updateSelf","rootReducer","room","reducer","actions","navigateToLobby","Room","chalk","GameController","createRoom","io","playerId","newRoom","addToRoomMap","addPlayerToRoomMap","to","emit","type","formattedRoom","joinRoom","enteredRoomCode","socket","checkRoomExists","join","rooms","get","id","addPlayerToRoom","formattedPlayer","playerLeft","console","log","blue","removePlayerFromRoom","error","red","set","playersToRooms","playersArray","filter","player","Map","enteredCode","has","length","addPlayer","size","roomName","logMapElements","value","key","map","forEach","playerRoom","green","remainingPlayers","playerID","MainController","gamecontroller","on","randomstring","callingPlayerId","generateRoomCode","generate","charset","push","readyToStart","Server","path","httpServer","cors","origin","express","socketServer","createServer","publicPath","__dirname","expressServer","use","req","res","sendFile","listen","mainController"],"sourceRoot":""}