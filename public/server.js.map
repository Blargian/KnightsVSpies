{"version":3,"file":"server.js","mappings":"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","sources":["webpack://spyspy/./client/reducers.js","webpack://spyspy/./server/controllers/gameController.js","webpack://spyspy/./server/controllers/lobbyController.js","webpack://spyspy/./server/controllers/mainController.js","webpack://spyspy/./server/models/game.js","webpack://spyspy/./server/models/room.js","webpack://spyspy/./server/models/round.js","webpack://spyspy/./server/socket.js","webpack://spyspy/external commonjs \"@reduxjs/toolkit\"","webpack://spyspy/external commonjs \"express\"","webpack://spyspy/external commonjs \"randomstring\"","webpack://spyspy/external commonjs \"socket.io\"","webpack://spyspy/external commonjs \"socket.io-client\"","webpack://spyspy/external node-commonjs \"http\"","webpack://spyspy/external node-commonjs \"path\"","webpack://spyspy/webpack/bootstrap","webpack://spyspy/webpack/runtime/compat get default export","webpack://spyspy/webpack/runtime/define property getters","webpack://spyspy/webpack/runtime/hasOwnProperty shorthand","webpack://spyspy/webpack/runtime/make namespace object","webpack://spyspy/./server/server.js"],"sourcesContent":["import { configureStore, createSlice, combineReducers, PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst initialGameState = {\r\n    players: [],\r\n    spies: [],\r\n    knights: [],\r\n    rounds: [],\r\n    leader: '',\r\n    showRoles: false,\r\n    allAcknowledged: false,\r\n    selectedPlayers: [],\r\n    currentRound: 0,\r\n    castToVote: false,\r\n    allowToVote: true,\r\n    showWinner: false,\r\n    knightsWon: false,\r\n}\r\n\r\nconst initialRoomState = {\r\n    selfId: '',\r\n    selfAlias: '',\r\n    players: [],\r\n    roomCode: null,\r\n    error: null,\r\n    gameStarted:false,\r\n}\r\n\r\nconst roomsSlice = createSlice({\r\n    name: \"room\",\r\n    initialState:initialRoomState,\r\n    reducers: {\r\n        ioCreateRoom(state,action){\r\n        },\r\n        roomCreated(state,{action,payload}){\r\n            return {...state,...payload}; \r\n        },\r\n        ioEnterRoomCode(state,{action,payload}){            \r\n        },\r\n        updatePlayers(state,{action,payload}){\r\n            return {...state, players: payload}\r\n        },\r\n        updateSelf(state,{action,payload}){\r\n            return {\r\n                ...state,\r\n                ...payload\r\n            }\r\n        },\r\n        errorOccured(state,{action,payload}){\r\n            return {\r\n                ...state,\r\n                error: payload\r\n            }\r\n        },\r\n        ioPlayerIsReady(state,{action,payload}){\r\n        },\r\n        ioStartGame(state){\r\n\r\n        },\r\n        navigateToGame(state){\r\n            return {\r\n                ...state,\r\n                gameStarted: true\r\n            }\r\n        },\r\n        returnAllRoomData(state,{action,payload}){\r\n            return {...state,...payload}\r\n        },\r\n    }\r\n});\r\n\r\nconst gameSlice = createSlice({\r\n    name:\"game\",\r\n    initialState:initialGameState,\r\n    reducers: {\r\n        updateGameState(state,{action,payload}){\r\n            return{\r\n                ...state,\r\n                ...payload\r\n            }\r\n        },\r\n        ioGetAllData(state){\r\n        },\r\n        ioPlayerAcknowledged(state){},\r\n        allPlayersAcknowledged(state,{action,payload}){\r\n            return {...state,allAcknowledged:true,showRoles:false}\r\n        },\r\n        ioUpdateSelectedPlayers(state,{action,payload}){\r\n        },\r\n        updateSelectedPlayers(state,{action,payload}){\r\n            return {...state,selectedPlayers:payload}\r\n        },\r\n        ioCastToVote(state,{action,payload}){},\r\n        updateCastToVote(state,{action,payload}){\r\n            return {...state,castToVote:payload}\r\n        },\r\n        ioPlayerCastVote(state,{action,payload}){},\r\n        updateAllowToVote(state,{action,payload}){\r\n            return {...state,allowToVote:payload}\r\n        },\r\n        showWinner(state,{action,payload}){\r\n            return {...state,showWinner:true,knightsWon:payload}\r\n        },\r\n        hideShowWinner(state,{action,payload}){\r\n            return {...state,showWinner:false}\r\n        },\r\n        resetGameState(state,{action,payload}){\r\n            return {\r\n                ...state,\r\n                leader:payload.newLeader,\r\n                selectedPlayers: [],\r\n                currentRound:payload.currentRound,\r\n                castToVote: false,\r\n                allowToVote: true,\r\n                showWinner: false,\r\n                knightsWon: false,\r\n                rounds: payload.rounds\r\n            }\r\n        }\r\n    }\r\n}\r\n);\r\n\r\n//Root reducer for usage in the store\r\nexport const rootReducer = combineReducers({\r\n    room: roomsSlice.reducer,\r\n    game: gameSlice.reducer,\r\n});\r\n\r\n//Make action creators accesible \r\n\r\nexport const {\r\n    ioCreateRoom,\r\n    roomCreated,\r\n    navigateToLobby,\r\n    ioEnterRoomCode,\r\n    updatePlayers,\r\n    updateSelf,\r\n    errorOccured,\r\n    ioPlayerIsReady,\r\n    ioStartGame,\r\n    navigateToGame,\r\n    returnAllRoomData\r\n} = roomsSlice.actions;\r\n\r\nexport const {\r\n    updateGameState,\r\n    ioGetAllData,\r\n    ioPlayerAcknowledged,\r\n    allPlayersAcknowledged,\r\n    ioUpdateSelectedPlayers,\r\n    updateSelectedPlayers,\r\n    ioCastToVote,\r\n    updateCastToVote,\r\n    ioPlayerCastVote,\r\n    updateAllowToVote,\r\n    showWinner,\r\n    hideShowWinner,\r\n    resetGameState\r\n} = gameSlice.actions;\r\n\r\n","import {Game} from '../models/game';\r\nimport Round from '../models/round';\r\n\r\nimport {\r\n    navigateToGame,\r\n} from '../../client/reducers';\r\nimport {\r\n    updateGameState,\r\n    allPlayersAcknowledged,\r\n    updateSelectedPlayers,\r\n    updateCastToVote,\r\n    updateAllowToVote,\r\n    showWinner,\r\n    hideShowWinner,\r\n    resetGameState\r\n} from '../../client/reducers';\r\nimport { io } from 'socket.io-client';\r\n\r\nexport default class GameController {\r\n    constructor(io){\r\n        this.io = io;\r\n        this.games = new Map();\r\n    }\r\n\r\n    createGame = function(room){\r\n        const game = new Game(room);\r\n        this.games.set(room.roomCode,game)\r\n        return game;\r\n    } \r\n\r\n    checkAllPlayersAcknowledged = function(roomCode){\r\n        let game = this.games.get(roomCode);\r\n        game.playersAcknowledgedRole++;\r\n        if(game.playersAcknowledgedRole === game.players.length){\r\n            this.io.in(roomCode).emit(allPlayersAcknowledged.type)\r\n        }\r\n        return game;\r\n    }\r\n\r\n    sendSelectedPlayersToRoom = function(roomCode, selectedPlayers){\r\n        this.io.in(roomCode).emit(updateSelectedPlayers.type,selectedPlayers);\r\n    }\r\n\r\n    updateCastToVote = function(roomCode, castToVote){\r\n        this.castToVote = castToVote;\r\n        this.io.in(roomCode).emit(updateCastToVote.type,castToVote);\r\n    }\r\n\r\n    getGameFromRoomcode = function(roomCode){\r\n        return this.games.get(roomCode);\r\n    }\r\n\r\n    setGameWithRoomcode = function(roomCode,game){\r\n        this.games.set(roomCode,game)\r\n    }\r\n\r\n    updatePlayerVote = function(gameToUpdate,selfId,missionPass){\r\n        let game = gameToUpdate;\r\n        missionPass ? game.rounds[game.currentRound].numberOfPass++ : game.rounds[game.currentRound].numberOfFail++;\r\n        let playerName = this.getNameFromId(game,selfId);\r\n        game.rounds[game.currentRound].playersOnMission.push(playerName);\r\n        return game;\r\n    }\r\n\r\n    checkAllPlayersVoted = function(roomCode){\r\n        const game = this.getGameFromRoomcode(roomCode)\r\n        const currentRound = game.rounds[game.currentRound]\r\n        if((currentRound.numberOfFail + currentRound.numberOfPass) === game.missionRules[game.players.length-5][game.currentRound]){\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    checkIfKnightsWin = function(roomCode){\r\n        let game = this.games.get(roomCode)\r\n        let currentRound = game.rounds[game.currentRound]\r\n        //if mission fails then spies won\r\n        if(currentRound.numberOfFail>=1 && game.players.length<7){\r\n            game.rounds[game.currentRound].knightsWon = false;\r\n            this.games.set(roomCode,game)\r\n            return false;\r\n        } else if (currentRound.numberOfFail>=2 && game.players.length >= 7 ){\r\n            game.rounds[game.currentRound].knightsWon = false;\r\n            this.games.set(roomCode,game)\r\n            return false;\r\n        } else {\r\n            game.rounds[game.currentRound].knightsWon = true;\r\n            this.games.set(roomCode,game)\r\n            return true;\r\n        }\r\n    }\r\n\r\n    transitionRound = function(roomCode){\r\n        let game = this.getGameFromRoomcode(roomCode);\r\n        let knightsWon = this.checkIfKnightsWin(roomCode);\r\n        this.storeWinner(knightsWon,this.getGameFromRoomcode(roomCode)) \r\n        this.incrementRound(game);\r\n        //send something back to the front-end to show the winner \r\n        this.io.in(roomCode).emit(showWinner.type,knightsWon);\r\n        setTimeout(()=>{\r\n            //wait 30 seconds and then\r\n            // hide the winners \r\n            this.io.in(roomCode).emit(hideShowWinner.type);\r\n            this.io.in(roomCode).emit(resetGameState.type,{rounds:game.rounds,currentRound:game.currentRound,newLeader:game.leader});\r\n        },10000)\r\n            \r\n            // increment the round and reset what needs to be reset\r\n    }\r\n\r\n    //need to add a new blank round\r\n    //set game.currentRound++\r\n    //game.selectedPlayers back to []\r\n    //game.leader = ''\r\n    //\r\n\r\n    storeWinner = function(knightsWin,game){\r\n        let updatedGame = game; \r\n        updatedGame.rounds[game.currentRound].knightsWon = knightsWin;\r\n        this.setGameWithRoomcode(updatedGame.roomCode, updatedGame);\r\n    }\r\n\r\n    incrementRound = function(game){\r\n        let updatedGame = game; \r\n        updatedGame.currentRound++;\r\n        updatedGame.leader = updatedGame.incrementMissionLeader(updatedGame.players,updatedGame.leader);\r\n        this.setGameWithRoomcode(updatedGame.roomCode,updatedGame);\r\n    }\r\n\r\n    //works under the assumption that player names will not be the same\r\n    getNameFromId = (game,providedSelfId) => {\r\n        let playerName = game.players.filter((player)=>{\r\n            return player.playerId===providedSelfId\r\n        })\r\n        if(playerName[0]){\r\n            return playerName[0].selfAlias;\r\n        } else {\r\n            return null;\r\n        }\r\n        \r\n    }\r\n\r\n    checkGameOver(rounds){\r\n        let timesKnightsWon = 0;\r\n        let timesSpiesWon = 0;\r\n        let gameOver = false;\r\n        let knightsWonGame = null;\r\n\r\n        rounds.forEach((round)=>{\r\n            if(round.knightsWon === true){\r\n                timesKnightsWon++;\r\n            } else if (round.knightsWon === false){\r\n                timesSpiesWon++;\r\n            }\r\n        })\r\n\r\n        if(timesKnightsWon===3){\r\n            gameOver = true;\r\n            knightsWonGame = true;\r\n            return [gameOver,knightsWonGame]\r\n        } else if (timesSpiesWon===3){\r\n            gameOver = true;\r\n            knightsWonGame = false;\r\n            return [gameOver,knightsWonGame]\r\n        } else {\r\n            return [false,null]\r\n        }\r\n    }\r\n}\r\n\r\nexport const communicateStartOfGame = (io, toRoom, game) => {\r\n    io.in(toRoom).emit(navigateToGame.type);\r\n    io.in(toRoom).emit(updateGameState.type,game);\r\n}\r\n\r\nexport const communicatePlayerCantVote = (io,selfId) => {\r\n    io.to(selfId).emit(updateAllowToVote.type,false)\r\n}\r\n\r\n\r\n","import {\r\n    roomCreated,\r\n    updatePlayers,\r\n    updateSelf,\r\n    errorOccured,\r\n    returnAllRoomData\r\n} from '../../client/reducers';\r\n\r\nimport { Room } from '../models/room';\r\n\r\n// one instance is made on server start up\r\nexport default class LobbyController{\r\n\r\n    constructor(io){\r\n        this.io=io;\r\n        this.rooms = new Map();\r\n        this.playersToRooms = new Map();\r\n    }\r\n\r\n    createRoom = function(playerId){\r\n        const newRoom = new Room(playerId);\r\n        this.addToRoomMap(newRoom);\r\n        this.addPlayerToRoomMap(newRoom,playerId);\r\n        this.io.to(playerId).emit(roomCreated.type,this.formattedRoom(newRoom,playerId));\r\n        return newRoom.roomCode\r\n    }\r\n\r\n    joinRoom = function(enteredRoomCode,socket){\r\n        if(this.checkRoomExists(enteredRoomCode)){\r\n            if(!this.roomIsFull(enteredRoomCode)){\r\n                socket.join(enteredRoomCode);\r\n                const room = this.rooms.get(enteredRoomCode)\r\n                this.addPlayerToRoomMap(room,socket.id)\r\n                const players = this.addPlayerToRoom(enteredRoomCode,socket.id)\r\n                //update this players state \r\n                this.io.to(socket.id).emit(updateSelf.type,this.formattedPlayer(enteredRoomCode,players,socket.id));\r\n                //update all players state with the list of players\r\n                this.io.in(enteredRoomCode).emit(updatePlayers.type,players);\r\n            } else {\r\n                this.io.to(socket.id).emit(errorOccured.type,'roomIsFull');\r\n            }\r\n        } else{\r\n            \r\n        }          \r\n    }\r\n\r\n    playerLeft = function(playerId){\r\n        try{\r\n            this.removePlayerFromRoom(playerId)\r\n        } catch(error){\r\n            console.log(chalk.red('an error occured trying to remove a player from their room'));\r\n            console.log(error);\r\n        }  \r\n    }\r\n\r\n    addToRoomMap = function(newRoom){\r\n        return this.rooms.set(newRoom.roomCode,newRoom);\r\n    }\r\n\r\n    addPlayerToRoomMap = function(newRoom,playerId){\r\n        return this.playersToRooms.set(playerId,newRoom.roomCode);\r\n    }\r\n\r\n    formattedRoom = function(newRoom,playerId){\r\n        return {\r\n            roomCode: newRoom.roomCode,\r\n            selfId: playerId,\r\n            selfAlias: newRoom.players[0].selfAlias,\r\n            players: newRoom.players\r\n        }\r\n    }\r\n\r\n    formattedPlayer = function(roomCode, playersArray,playerId){\r\n\r\n        const selfAlias = playersArray.filter((player)=>{\r\n            return player.selfId === playerId\r\n        }).selfAlias\r\n\r\n        return {\r\n            roomCode: roomCode, \r\n            selfId: playerId,\r\n            selfAlias\r\n        }\r\n    }\r\n\r\n    checkRoomExists(enteredCode){\r\n        return this.rooms.has(enteredCode)\r\n    }\r\n\r\n    addPlayerToRoom(enteredRoomCode, player){\r\n        let room = this.rooms.get(enteredRoomCode);\r\n        if(room){\r\n            if(room.players.length<10){\r\n                room.addPlayer(player);\r\n            }\r\n            return room.players;\r\n        } else {\r\n            console.log(chalk.red(`no room was found for ${enteredCode}`))\r\n        }\r\n    }\r\n\r\n    removePlayerFromRoom(playerId){\r\n        if(this.playersToRooms.size===0 || this.playersToRooms.get(playerId) === undefined){\r\n            return;\r\n        }\r\n        let roomName = this.playersToRooms.get(playerId);\r\n        let playerRoom = this.rooms.get(roomName);\r\n        if(playerRoom){\r\n            \r\n            let remainingPlayers = (playerRoom.players).filter((player)=>{\r\n                return player.playerId !== playerId\r\n            });\r\n    \r\n            playerRoom = {\r\n                ...playerRoom, \r\n                players:remainingPlayers\r\n            }\r\n    \r\n            if(playerRoom.players.length===0){\r\n                this.rooms.delete(roomName);    \r\n            } else {\r\n                this.rooms.set(roomName,playerRoom);\r\n                this.io.in(roomName).emit(updatePlayers.type,remainingPlayers);\r\n            } \r\n        }\r\n    }\r\n\r\n    roomIsFull = function(roomCode) {\r\n        let room = this.rooms.get(roomCode);\r\n        return room.players.length < 10 ? false : true; \r\n    }\r\n\r\n    //returns an updated player array where the callingPlayer's isReady property is flipped\r\n    updatePlayerReadiness = function(callingPlayerId){\r\n        const room = this.rooms.get(this.playersToRooms.get(callingPlayerId))\r\n        const updatedPlayerArray = (room.players||[]).map((player)=>{\r\n            if(player.playerId === callingPlayerId){\r\n                return {...player,readyToStart:!player.readyToStart}\r\n            } else {\r\n                return player;\r\n            }\r\n        })\r\n        return updatedPlayerArray\r\n    }\r\n\r\n    sendUpdatedPlayersToRoom = function(updatedPlayers,enteredRoomCode){\r\n        this.io.in(enteredRoomCode).emit(updatePlayers.type,updatedPlayers);\r\n    }\r\n\r\n    getRoom = function(enteredRoomCode){\r\n        return this.rooms.get(enteredRoomCode);\r\n    }\r\n\r\n    emitAllRoomData = function(enteredRoomCode, socketId){\r\n        //Problem here is that the socket id changes between refreshes\r\n        //Would have to implement a way to cache the player session\r\n    }\r\n\r\n}\r\n\r\n\r\n","import LobbyController from \"./lobbyController\";\r\nimport GameController, {communicateStartOfGame,communicatePlayerCantVote} from \"./gameController\";\r\n\r\nimport {\r\n    ioCreateRoom,\r\n    ioEnterRoomCode,\r\n    ioPlayerIsReady,\r\n    ioStartGame,\r\n    errorOccured,\r\n    ioPlayerAcknowledged,\r\n    ioUpdateSelectedPlayers,\r\n    ioGetAllData,\r\n    ioCastToVote,\r\n    ioPlayerCastVote\r\n} from '../../client/reducers';\r\n\r\n//Handles socket \r\nexport default class MainController {\r\n    constructor(io){\r\n        this.io = io;\r\n        this.lobbyController = new LobbyController(this.io);\r\n        this.gameController = new GameController(this.io);\r\n\r\n        this.io.on(\"connection\", (socket) => {\r\n\r\n            socket.on(ioCreateRoom.type,()=>{\r\n                socket.join(this.lobbyController.createRoom(socket.id));\r\n            });\r\n    \r\n            socket.on(ioEnterRoomCode.type,(enteredRoomCode)=>{\r\n                 this.lobbyController.joinRoom(enteredRoomCode,socket);\r\n            });\r\n\r\n            socket.on(\"disconnect\",()=>{\r\n               this.lobbyController.playerLeft(socket.id)\r\n            })\r\n\r\n            socket.on(ioPlayerIsReady.type,(payload)=>{\r\n                const updatedPlayers = this.lobbyController.updatePlayerReadiness(payload.playerId);\r\n                this.lobbyController.rooms.get(payload.roomCode).updatePlayers(updatedPlayers);\r\n                this.lobbyController.sendUpdatedPlayersToRoom(updatedPlayers,payload.roomCode);\r\n            });\r\n\r\n            socket.on(ioStartGame.type,(enteredRoomCode)=>{\r\n                const room = this.lobbyController.getRoom(enteredRoomCode)\r\n                if(room){\r\n                    let game = this.gameController.createGame(room);\r\n                    communicateStartOfGame(io,room.roomCode,game);\r\n                } else {\r\n                    console.log('Tried to create a gameController without valid room object passed. Passed to function:')\r\n                    console.log(room)\r\n                }\r\n            })\r\n\r\n            socket.on(ioGetAllData.type,(enteredRoomCode)=>{\r\n                if(this.lobbyController.checkRoomExists(enteredRoomCode)){\r\n                    this.lobbyController.emitAllRoomData(enteredRoomCode,socket.id)\r\n                } else {\r\n                    io.to(socket.id).emit(errorOccured.type,'No Such Room Exists...');\r\n                }\r\n            })\r\n\r\n            socket.on(ioPlayerAcknowledged.type,(enteredRoomCode)=>{\r\n                this.gameController.setGameWithRoomcode(this.gameController.checkAllPlayersAcknowledged(enteredRoomCode));\r\n            })\r\n\r\n            socket.on(ioUpdateSelectedPlayers.type,(payload)=>{\r\n                this.gameController.sendSelectedPlayersToRoom(payload.roomCode,payload.newSelectedPlayers)\r\n            })\r\n\r\n            socket.on(ioCastToVote.type,(payload)=>{\r\n                this.gameController.updateCastToVote(payload.roomCode,payload.castToVote)\r\n            })\r\n\r\n            socket.on(ioPlayerCastVote.type,(payload)=>{\r\n                this.gameController.setGameWithRoomcode(this.gameController.updatePlayerVote(this.gameController.getGameFromRoomcode(payload.roomCode),payload.selfId,payload.missionPass));\r\n                communicatePlayerCantVote(io,payload.selfId);\r\n                let allPlayersVoted = this.gameController.checkAllPlayersVoted(payload.roomCode);\r\n                if(allPlayersVoted){\r\n                    this.gameController.transitionRound(payload.roomCode);\r\n                    let [gameOver,knightsWonGame] = this.gameController.checkGameOver(this.gameController.getGameFromRoomcode(payload.roomCode).rounds);\r\n                    if(!gameOver){\r\n                    } else {\r\n                        console.log('Game over')\r\n                    }\r\n                }\r\n            })\r\n        });\r\n    }\r\n}","import Round from '../models/round';\r\nimport { Room } from './room';\r\n\r\nexport class Game {\r\n    constructor(room){\r\n        this.roomCode = room.roomCode;\r\n        this.players = [...room.players];\r\n        this.numberOfPlayers = this.players.length;\r\n        let selectedRoles = this.selectRoles(this.players)\r\n        this.spies = selectedRoles.spies;\r\n        this.knights = selectedRoles.knights;\r\n        this.rounds = [\r\n            new Round(),\r\n            new Round(),\r\n            new Round(),\r\n            new Round(),\r\n            new Round(),\r\n        ];\r\n        this.leader = this.selectMissionLeader(this.players);\r\n        this.showRoles = true;\r\n        this.playersAcknowledgedRole = 0;\r\n        this.castToVote = false;\r\n        this.currentRound = 0;\r\n        this.missionRules = [\r\n            [2,3,2,3,3], //5 players\r\n            [2,3,4,3,4], //6 players\r\n            [2,3,3,4,4], //7 players\r\n            [3,4,4,5,5], //8 players\r\n            [3,4,4,5,5], //9 players\r\n            [3,4,4,5,5] //10 players\r\n        ]\r\n    }\r\n\r\n    //selects 1/3 (rounded up) of players to be spies \r\n    selectRoles = function(players){\r\n        let playersArray = [...players];\r\n        let spies = []\r\n        let knights = []\r\n        //assign the spies\r\n        while(spies.length<Math.ceil((players.length*0.33))){\r\n            let randomIndex = Math.ceil((Math.random()*playersArray.length))-1;\r\n            spies.push(playersArray[randomIndex])\r\n            playersArray.splice(randomIndex,1)\r\n        }\r\n        knights = playersArray; //assign the remaining knights\r\n\r\n        return {spies, knights};\r\n    }\r\n\r\n    selectMissionLeader = function(players){\r\n        let randomIndex = Math.ceil((Math.random()*players.length))-1;\r\n        return players[randomIndex].playerId;\r\n    }\r\n\r\n    // incrementMissionLeader = function(players,previousMissionLeader)\r\n    // if previous leader is number 4, should return 5\r\n    // if previous leader is 5 should return 1\r\n\r\n    incrementMissionLeader = function(players,previousMissionLeader){\r\n        let previousLeaderIndex = players.findIndex(player => player.playerId===previousMissionLeader);\r\n        let leaderIsLast = previousLeaderIndex === players.length-1;\r\n        if(leaderIsLast){\r\n            return players[0].playerId;\r\n        } else {\r\n            return players[previousLeaderIndex+1].playerId;\r\n        }\r\n    }\r\n}","import randomstring from \"randomstring\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nexport class Room {\r\n\r\n    //callingPlayerId: socket.id\r\n    constructor(callingPlayerId){\r\n        this.roomCode = this.generateRoomCode();\r\n        this.players = [];\r\n        this.addPlayer(callingPlayerId)\r\n    }\r\n\r\n    generateRoomCode = function(){\r\n        return randomstring.generate({\r\n            length: 6,\r\n            charset: 'alphanumeric'\r\n        });\r\n    }\r\n\r\n    addPlayer = function(callingPlayerId){\r\n        this.players.push({\r\n            playerId:callingPlayerId,\r\n            selfAlias:`Player${this.players.length+1}`,\r\n            readyToStart: false\r\n        });\r\n    }\r\n\r\n    updatePlayers = function(newPlayerArray){\r\n        this.players = newPlayerArray;\r\n    }\r\n\r\n}","export default class Round {\r\n    constructor(){\r\n        this.playersOnMission= [];\r\n        this.numberOfPass = 0;\r\n        this.numberOfFail = 0;\r\n        this.knightsWon = undefined;\r\n    }\r\n}","import { Server } from 'socket.io';\r\nimport path from 'path';\r\n\r\nexport default (httpServer) => {\r\n\r\n    console.log('Setting up socket.io server...');\r\n    const io = new Server(httpServer,{\r\n        cors: {\r\n            origin: \"*\"\r\n        },\r\n    });\r\n\r\n    return io;\r\n}","module.exports = require(\"@reduxjs/toolkit\");","module.exports = require(\"express\");","module.exports = require(\"randomstring\");","module.exports = require(\"socket.io\");","module.exports = require(\"socket.io-client\");","module.exports = require(\"http\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import express from 'express';\r\nimport socketServer from \"./socket\";\r\nimport {createServer} from 'http';\r\nimport path from 'path';\r\nconst publicPath = path.join(__dirname, '..', 'public','dist');\r\nimport MainController from './controllers/mainController';\r\n\r\nconst expressServer = express();\r\nexpressServer.use(express.static(publicPath));\r\nexpressServer.get('*', (req, res)=>{\r\n    res.sendFile(path.join(publicPath,'index.html'));\r\n})\r\n\r\nconst httpServer = createServer(expressServer);\r\n\r\nconst io = socketServer(httpServer);\r\n\r\nconst port = process.env.PORT || 3000\r\nhttpServer.listen(port, ()=> {\r\n    console.log(`Server running on port ${port}`);\r\n});\r\n\r\nconst mainController = new MainController(io);\r\n\r\n\r\n"],"names":["configureStore","createSlice","combineReducers","PayloadAction","initialGameState","players","spies","knights","rounds","leader","showRoles","allAcknowledged","selectedPlayers","currentRound","castToVote","allowToVote","showWinner","knightsWon","initialRoomState","selfId","selfAlias","roomCode","error","gameStarted","roomsSlice","name","initialState","reducers","ioCreateRoom","state","action","roomCreated","payload","ioEnterRoomCode","updatePlayers","updateSelf","errorOccured","ioPlayerIsReady","ioStartGame","navigateToGame","returnAllRoomData","gameSlice","updateGameState","ioGetAllData","ioPlayerAcknowledged","allPlayersAcknowledged","ioUpdateSelectedPlayers","updateSelectedPlayers","ioCastToVote","updateCastToVote","ioPlayerCastVote","updateAllowToVote","hideShowWinner","resetGameState","newLeader","rootReducer","room","reducer","game","actions","navigateToLobby","Game","Round","io","GameController","games","set","get","playersAcknowledgedRole","length","emit","type","gameToUpdate","missionPass","numberOfPass","numberOfFail","playerName","getNameFromId","playersOnMission","push","getGameFromRoomcode","missionRules","checkIfKnightsWin","storeWinner","incrementRound","setTimeout","knightsWin","updatedGame","setGameWithRoomcode","incrementMissionLeader","providedSelfId","filter","player","playerId","Map","timesKnightsWon","timesSpiesWon","gameOver","knightsWonGame","forEach","round","communicateStartOfGame","toRoom","communicatePlayerCantVote","to","Room","LobbyController","newRoom","addToRoomMap","addPlayerToRoomMap","formattedRoom","enteredRoomCode","socket","checkRoomExists","roomIsFull","join","rooms","id","addPlayerToRoom","formattedPlayer","removePlayerFromRoom","console","log","chalk","red","playersToRooms","playersArray","callingPlayerId","updatedPlayerArray","map","readyToStart","updatedPlayers","socketId","enteredCode","has","addPlayer","size","undefined","roomName","playerRoom","remainingPlayers","MainController","lobbyController","gameController","on","createRoom","joinRoom","playerLeft","updatePlayerReadiness","sendUpdatedPlayersToRoom","getRoom","createGame","emitAllRoomData","checkAllPlayersAcknowledged","sendSelectedPlayersToRoom","newSelectedPlayers","updatePlayerVote","allPlayersVoted","checkAllPlayersVoted","transitionRound","checkGameOver","Math","ceil","randomIndex","random","splice","previousMissionLeader","previousLeaderIndex","findIndex","leaderIsLast","numberOfPlayers","selectedRoles","selectRoles","selectMissionLeader","randomstring","generate","charset","newPlayerArray","generateRoomCode","Server","path","httpServer","cors","origin","express","socketServer","createServer","publicPath","__dirname","expressServer","use","req","res","sendFile","port","process","env","PORT","listen","mainController"],"sourceRoot":""}