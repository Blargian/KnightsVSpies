(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=require("express");var o=e.n(t);const r=require("socket.io"),n=require("path");var i=e.n(n);const a=require("http"),l=require("@reduxjs/toolkit");function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?u(Object(o),!0).forEach((function(t){f(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function f(e,t,o){return(t=function(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var y=(0,l.createSlice)({name:"room",initialState:{selfId:"",selfAlias:"",players:[],roomCode:null,error:null,gameStarted:!1},reducers:{ioCreateRoom:function(e,t){},roomCreated:function(e,t){t.action;var o=t.payload;return c(c({},e),o)},ioEnterRoomCode:function(e,t){t.action,t.payload},updatePlayers:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{players:o})},updateSelf:function(e,t){t.action;var o=t.payload;return c(c({},e),o)},errorOccured:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{error:o})},ioPlayerIsReady:function(e,t){t.action,t.payload},ioStartGame:function(e){},navigateToGame:function(e){return c(c({},e),{},{gameStarted:!0})},returnAllRoomData:function(e,t){t.action;var o=t.payload;return c(c({},e),o)}}}),m=(0,l.createSlice)({name:"game",initialState:{players:[],spies:[],knights:[],rounds:[],leader:"",showRoles:!1,allAcknowledged:!1,selectedPlayers:[],currentRound:0,castToVote:!1,allowToVote:!0,showWinner:!1,knightsWon:!1},reducers:{updateGameState:function(e,t){t.action;var o=t.payload;return c(c({},e),o)},ioGetAllData:function(e){},ioPlayerAcknowledged:function(e){},allPlayersAcknowledged:function(e,t){return t.action,t.payload,c(c({},e),{},{allAcknowledged:!0,showRoles:!1})},ioUpdateSelectedPlayers:function(e,t){t.action,t.payload},updateSelectedPlayers:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{selectedPlayers:o})},ioCastToVote:function(e,t){t.action,t.payload},updateCastToVote:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{castToVote:o})},ioPlayerCastVote:function(e,t){t.action,t.payload},updateAllowToVote:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{allowToVote:o})},showWinner:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{showWinner:!0,knightsWon:o})},hideShowWinner:function(e,t){return t.action,t.payload,c(c({},e),{},{showWinner:!1})},resetGameState:function(e,t){t.action;var o=t.payload;return c(c({},e),{},{leader:o.newLeader,selectedPlayers:[],currentRound:o.currentRound,castToVote:!1,allowToVote:!0,showWinner:!1,knightsWon:!1,rounds:o.rounds})},ioVetoMissionHandler:function(e,t){t.action,t.payload},updateMissionVetoed:function(e,t){t.action;var o=t.payload;e.rounds[e.currentRound].missionWasVetoed=o}}}),d=((0,l.combineReducers)({room:y.reducer,game:m.reducer}),y.actions),p=d.ioCreateRoom,h=d.roomCreated,b=(d.navigateToLobby,d.ioEnterRoomCode),v=d.updatePlayers,g=d.updateSelf,w=d.errorOccured,P=d.ioPlayerIsReady,S=d.ioStartGame,R=d.navigateToGame,O=(d.returnAllRoomData,m.actions),C=O.updateGameState,j=O.ioGetAllData,T=O.ioPlayerAcknowledged,k=O.allPlayersAcknowledged,A=O.ioUpdateSelectedPlayers,V=O.updateSelectedPlayers,M=O.ioCastToVote,I=O.updateCastToVote,G=O.ioPlayerCastVote,W=O.updateAllowToVote,E=O.showWinner,F=O.hideShowWinner,D=O.resetGameState,L=O.ioVetoMissionHandler,x=O.updateMissionVetoed;const q=require("randomstring");var U=e.n(q);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function N(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$(r.key),r)}}function H(e,t,o){return t&&N(e.prototype,t),o&&N(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function K(e,t,o){return(t=$(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function $(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_(t)?t:String(t)}require("socket.io-client");var z=H((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),K(this,"generateRoomCode",(function(){return U().generate({length:6,charset:"alphanumeric"})})),K(this,"addPlayer",(function(e){this.players.push({playerId:e,selfAlias:"Player".concat(this.players.length+1),readyToStart:!1})})),K(this,"updatePlayers",(function(e){this.players=e})),this.roomCode=this.generateRoomCode(),this.players=[],this.addPlayer(t)}));function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function J(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function Q(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?J(Object(o),!0).forEach((function(t){Y(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):J(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function X(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Z(r.key),r)}}function Y(e,t,o){return(t=Z(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Z(e){var t=function(e,t){if("object"!==B(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===B(t)?t:String(t)}var ee=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Y(this,"createRoom",(function(e){var t=new z(e);return this.addToRoomMap(t),this.addPlayerToRoomMap(t,e),this.io.to(e).emit(h.type,this.formattedRoom(t,e)),t.roomCode})),Y(this,"joinRoom",(function(e,t){if(this.checkRoomExists(e))if(this.roomIsFull(e))this.io.to(t.id).emit(w.type,"roomIsFull");else{t.join(e);var o=this.rooms.get(e);this.addPlayerToRoomMap(o,t.id);var r=this.addPlayerToRoom(e,t.id);this.io.to(t.id).emit(g.type,this.formattedPlayer(e,r,t.id)),this.io.in(e).emit(v.type,r)}})),Y(this,"playerLeft",(function(e){try{this.removePlayerFromRoom(e)}catch(e){console.log(chalk.red("an error occured trying to remove a player from their room")),console.log(e)}})),Y(this,"addToRoomMap",(function(e){return this.rooms.set(e.roomCode,e)})),Y(this,"addPlayerToRoomMap",(function(e,t){return this.playersToRooms.set(t,e.roomCode)})),Y(this,"formattedRoom",(function(e,t){return{roomCode:e.roomCode,selfId:t,selfAlias:e.players[0].selfAlias,players:e.players}})),Y(this,"formattedPlayer",(function(e,t,o){var r=t.filter((function(e){return e.selfId===o})).selfAlias;return{roomCode:e,selfId:o,selfAlias:r}})),Y(this,"roomIsFull",(function(e){return!(this.rooms.get(e).players.length<10)})),Y(this,"updatePlayerReadiness",(function(e){return(this.rooms.get(this.playersToRooms.get(e)).players||[]).map((function(t){return t.playerId===e?Q(Q({},t),{},{readyToStart:!t.readyToStart}):t}))})),Y(this,"sendUpdatedPlayersToRoom",(function(e,t){this.io.in(t).emit(v.type,e)})),Y(this,"getRoom",(function(e){return this.rooms.get(e)})),Y(this,"emitAllRoomData",(function(e,t){})),this.io=t,this.rooms=new Map,this.playersToRooms=new Map}var t,o;return t=e,(o=[{key:"checkRoomExists",value:function(e){return this.rooms.has(e)}},{key:"addPlayerToRoom",value:function(e,t){var o=this.rooms.get(e);if(o)return o.players.length<10&&o.addPlayer(t),o.players;console.log(chalk.red("no room was found for ".concat(enteredCode)))}},{key:"removePlayerFromRoom",value:function(e){if(0!==this.playersToRooms.size&&void 0!==this.playersToRooms.get(e)){var t=this.playersToRooms.get(e),o=this.rooms.get(t);if(o){var r=o.players.filter((function(t){return t.playerId!==e}));0===(o=Q(Q({},o),{},{players:r})).players.length?this.rooms.delete(t):(this.rooms.set(t,o),this.io.in(t).emit(v.type,r))}}}}])&&X(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function oe(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,n=function(e,t){if("object"!==te(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===te(n)?n:String(n)),r)}var n}function re(e,t,o){return t&&oe(e.prototype,t),o&&oe(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var ne=re((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playersOnMission=[],this.numberOfPass=0,this.numberOfFail=0,this.knightsWon=void 0,this.accepted=[],this.vetoed=[],this.missionWasVetoed=null}));function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e){return function(e){if(Array.isArray(e))return le(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return le(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?le(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function se(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fe(r.key),r)}}function ue(e,t,o){return t&&se(e.prototype,t),o&&se(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function ce(e,t,o){return(t=fe(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function fe(e){var t=function(e,t){if("object"!==ie(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ie(t)?t:String(t)}var ye=ue((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ce(this,"selectRoles",(function(e){for(var t=ae(e),o=[];o.length<Math.ceil(.33*e.length);){var r=Math.ceil(Math.random()*t.length)-1;o.push(t[r]),t.splice(r,1)}return{spies:o,knights:t}})),ce(this,"selectMissionLeader",(function(e){return e[Math.ceil(Math.random()*e.length)-1].playerId})),ce(this,"incrementMissionLeader",(function(e,t){var o=e.findIndex((function(e){return e.playerId===t}));return o===e.length-1?e[0].playerId:e[o+1].playerId})),this.roomCode=t.roomCode,this.players=ae(t.players),this.numberOfPlayers=this.players.length;var o=this.selectRoles(this.players);this.spies=o.spies,this.knights=o.knights,this.rounds=[new ne,new ne,new ne,new ne,new ne],this.leader=this.selectMissionLeader(this.players),this.showRoles=!0,this.playersAcknowledgedRole=0,this.castToVote=!1,this.currentRound=0,this.missionRules=[[2,3,2,3,3],[2,3,4,3,4],[2,3,3,4,4],[3,4,4,5,5],[3,4,4,5,5],[3,4,4,5,5]],this.numberOfVetos=0}));function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function de(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,he(r.key),r)}}function pe(e,t,o){return(t=he(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function he(e){var t=function(e,t){if("object"!==me(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===me(t)?t:String(t)}var be=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),pe(this,"createGame",(function(e){var t=new ye(e);return this.games.set(e.roomCode,t),t})),pe(this,"checkAllPlayersAcknowledged",(function(e){var t=this.games.get(e);return t.playersAcknowledgedRole++,t.playersAcknowledgedRole===t.players.length&&this.io.in(e).emit(k.type),t})),pe(this,"sendSelectedPlayersToRoom",(function(e,t){this.io.in(e).emit(V.type,t)})),pe(this,"updateCastToVote",(function(e,t){this.castToVote=t,this.io.in(e).emit(I.type,t)})),pe(this,"getGameFromRoomcode",(function(e){return this.games.get(e)})),pe(this,"setGameWithRoomcode",(function(e,t){this.games.set(e,t)})),pe(this,"updateVetoDecision",(function(e,t,o){var r=this.getGameFromRoomcode(e);!0===o?(r.numberOfVetos++,r.rounds[r.currentRound].vetoed.push(t)):!1===o&&r.rounds[r.currentRound].accepted.push(t)})),pe(this,"checkVetoStatus",(function(e){var t={allPlayersVoted:!1,vetoMission:!1},o=this.getGameFromRoomcode(e),r=o.rounds[o.currentRound];return r.vetoed.length+r.accepted.length===o.players.length&&(t.allPlayersVoted=!0),r.vetoed.length>r.accepted.length?t.vetoMission=!0:t.vetoMission=!1,t})),pe(this,"updateMissionVetoed",(function(e,t){t?(this.io.in(e).emit(x.type,!0),this.transitionRound(e)):this.io.in(e).emit(x.type,!1)})),pe(this,"updatePlayerVote",(function(e,t,o){var r=e;o?r.rounds[r.currentRound].numberOfPass++:r.rounds[r.currentRound].numberOfFail++;var n=this.getNameFromId(r,t);return r.rounds[r.currentRound].playersOnMission.push(n),r})),pe(this,"checkAllPlayersVoted",(function(e){var t=this.getGameFromRoomcode(e),o=t.rounds[t.currentRound];return o.numberOfFail+o.numberOfPass===t.missionRules[t.players.length-5][t.currentRound]})),pe(this,"checkIfKnightsWin",(function(e){var t=this.games.get(e),o=t.rounds[t.currentRound];return 0===o.numberOfFail&&0===o.numberOfPass?null:o.numberOfFail>=1&&t.players.length<7||o.numberOfFail>=2&&t.players.length>=7?(t.rounds[t.currentRound].knightsWon=!1,this.games.set(e,t),!1):(t.rounds[t.currentRound].knightsWon=!0,this.games.set(e,t),!0)})),pe(this,"transitionRound",(function(e){var t=this,o=this.getGameFromRoomcode(e),r=this.checkIfKnightsWin(e);null!==r?(o.numberOfVetos=0,this.storeWinner(r,this.getGameFromRoomcode(e)),this.incrementRound(o)):this.resetRound(o),this.incrementLeader(o),this.io.in(e).emit(E.type,r),setTimeout((function(){t.io.in(e).emit(F.type),t.io.in(e).emit(D.type,{rounds:o.rounds,currentRound:o.currentRound,newLeader:o.leader})}),1e4)})),pe(this,"resetRound",(function(e){var t=e;t.rounds[e.currentRound]=new ne,this.setGameWithRoomcode(t.roomCode,t)})),pe(this,"storeWinner",(function(e,t){var o=t;o.rounds[t.currentRound].knightsWon=e,this.setGameWithRoomcode(o.roomCode,o)})),pe(this,"incrementRound",(function(e){var t=e;t.currentRound++,this.setGameWithRoomcode(t.roomCode,t)})),pe(this,"incrementLeader",(function(e){var t=e;t.leader=t.incrementMissionLeader(t.players,t.leader),this.setGameWithRoomcode(t.roomCode,t)})),pe(this,"getNameFromId",(function(e,t){var o=e.players.filter((function(e){return e.playerId===t}));return o[0]?o[0].selfAlias:null})),this.io=t,this.games=new Map}var t,o;return t=e,(o=[{key:"checkGameOver",value:function(e){var t=0,o=0;return this.game.numberOfVetos===game.players.length?[!0,null]:(e.forEach((function(e){!0===e.knightsWon?t++:!1===e.knightsWon&&o++})),3===t?[!0,!0]:3===o?[!0,!1]:[!1,null])}}])&&de(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function we(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,n=function(e,t){if("object"!==ve(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ve(n)?n:String(n)),r)}var n}function Pe(e,t,o){return t&&we(e.prototype,t),o&&we(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var Se=Pe((function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.io=t,this.lobbyController=new ee(this.io),this.gameController=new be(this.io),this.io.on("connection",(function(e){e.on(p.type,(function(){e.join(o.lobbyController.createRoom(e.id))})),e.on(b.type,(function(t){o.lobbyController.joinRoom(t,e)})),e.on("disconnect",(function(){o.lobbyController.playerLeft(e.id)})),e.on(P.type,(function(e){var t=o.lobbyController.updatePlayerReadiness(e.playerId);o.lobbyController.rooms.get(e.roomCode).updatePlayers(t),o.lobbyController.sendUpdatedPlayersToRoom(t,e.roomCode)})),e.on(S.type,(function(e){var r=o.lobbyController.getRoom(e);if(r){var n=o.gameController.createGame(r);!function(e,t,o){e.in(t).emit(R.type),e.in(t).emit(C.type,o)}(t,r.roomCode,n)}else console.log("Tried to create a gameController without valid room object passed. Passed to function:"),console.log(r)})),e.on(j.type,(function(r){o.lobbyController.checkRoomExists(r)?o.lobbyController.emitAllRoomData(r,e.id):t.to(e.id).emit(w.type,"No Such Room Exists...")})),e.on(T.type,(function(e){o.gameController.setGameWithRoomcode(o.gameController.checkAllPlayersAcknowledged(e))})),e.on(A.type,(function(e){o.gameController.sendSelectedPlayersToRoom(e.roomCode,e.newSelectedPlayers)})),e.on(M.type,(function(e){o.gameController.updateCastToVote(e.roomCode,e.castToVote)})),e.on(G.type,(function(e){if(o.gameController.setGameWithRoomcode(o.gameController.updatePlayerVote(o.gameController.getGameFromRoomcode(e.roomCode),e.selfId,e.missionPass)),function(e,t){e.to(t).emit(W.type,!1)}(t,e.selfId),o.gameController.checkAllPlayersVoted(e.roomCode)){o.gameController.transitionRound(e.roomCode);var r=(i=o.gameController.checkGameOver(o.gameController.getGameFromRoomcode(e.roomCode).rounds),a=2,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var r,n,i,a,l=[],s=!0,u=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;s=!1}else for(;!(s=(r=i.call(o)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,n=e}finally{try{if(!s&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(u)throw n}}return l}}(i,a)||function(e,t){if(e){if("string"==typeof e)return ge(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ge(e,t):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0];r[1],n&&console.log("Game over")}var i,a})),e.on(L.type,(function(e){o.gameController.updateVetoDecision(e.roomCode,e.playerId,e.vetoMission);var t=o.gameController.checkVetoStatus(e.roomCode);console.log("veto status: ".concat(t.allPlayersVoted)),t.allPlayersVoted&&o.gameController.updateMissionVetoed(e.roomCode,t.vetoMission)}))}))})),Re=i().join(__dirname,"..","public","dist"),Oe=o()();Oe.use(o().static(Re)),Oe.get("*",(function(e,t){t.sendFile(i().join(Re,"index.html"))}));var Ce=(0,a.createServer)(Oe),je=function(e){return console.log("Setting up socket.io server..."),new r.Server(e,{cors:{origin:"*"}})}(Ce),Te=process.env.PORT||3e3;Ce.listen(Te,(function(){console.log("Server running on port ".concat(Te))})),new Se(je)})();